{"remainingRequest":"D:\\MyResearch\\WakitaLab\\ProjectTDB\\Code\\11.10\\2021-11-22_CHEN_TDBDemo-Flask-Vue1\\client\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!D:\\MyResearch\\WakitaLab\\ProjectTDB\\Code\\11.10\\2021-11-22_CHEN_TDBDemo-Flask-Vue1\\client\\src\\components\\Visualization\\StackedNormalizedHorizontalBar.vue?vue&type=style&index=0&id=e5b811e8&scoped=true&lang=css","dependencies":[{"path":"D:\\MyResearch\\WakitaLab\\ProjectTDB\\Code\\11.10\\2021-11-22_CHEN_TDBDemo-Flask-Vue1\\client\\src\\components\\Visualization\\StackedNormalizedHorizontalBar.vue","mtime":1638741701022},{"path":"D:\\MyResearch\\WakitaLab\\ProjectTDB\\Code\\11.10\\2021-11-22_CHEN_TDBDemo-Flask-Vue1\\client\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\MyResearch\\WakitaLab\\ProjectTDB\\Code\\11.10\\2021-11-22_CHEN_TDBDemo-Flask-Vue1\\client\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1632349277000},{"path":"D:\\MyResearch\\WakitaLab\\ProjectTDB\\Code\\11.10\\2021-11-22_CHEN_TDBDemo-Flask-Vue1\\client\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\MyResearch\\WakitaLab\\ProjectTDB\\Code\\11.10\\2021-11-22_CHEN_TDBDemo-Flask-Vue1\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\MyResearch\\WakitaLab\\ProjectTDB\\Code\\11.10\\2021-11-22_CHEN_TDBDemo-Flask-Vue1\\client\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1632349277000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQpjaGFydC1pbmZvIHsNCiAgZm9udC1zaXplOiAxNHB4Ow0KICBjb2xvcjogIzAwMDBmZjsNCiAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgbWFyZ2luLWxlZnQ6IDMwJTsNCn0NCi5yaWdodEMgew0KICBtYXJnaW4tbGVmdDogNDIlOw0KICBtYXJnaW4tdG9wOiAtMTclOw0KfQ0KLyogI3N2Z0N1cnZlMiB7DQogIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgYm9yZGVyOiAycHggZGFzaGVkIHB1cnBsZTsNCiAgd2lkdGg6IDMwMHB4Ow0KICBoZWlnaHQ6IDEyMHB4Ow0KICBsZWZ0OiAxMSU7DQp9ICovDQo="},{"version":3,"sources":["D:\\MyResearch\\WakitaLab\\ProjectTDB\\Code\\11.10\\2021-11-22_CHEN_TDBDemo-Flask-Vue1\\client\\src\\components\\Visualization\\StackedNormalizedHorizontalBar.vue"],"names":[],"mappings":";AA2JA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACT,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACf,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACd,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACjB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAClB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAClB;AACA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACN,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EAChB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AAClB;AACA,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACZ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAClB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACzB,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EACZ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EACb,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AACX,EAAE,CAAC","file":"D:/MyResearch/WakitaLab/ProjectTDB/Code/11.10/2021-11-22_CHEN_TDBDemo-Flask-Vue1/client/src/components/Visualization/StackedNormalizedHorizontalBar.vue","sourceRoot":"","sourcesContent":["<script>\r\nimport axios from \"axios\";\r\nimport * as d3 from \"d3\";\r\n\r\nvar f1aData = \"default\";\r\n\r\nexport default {\r\n  name: \"StackedBar\",\r\n  data() {\r\n    var data = null;\r\n    return {\r\n      data,\r\n    };\r\n  },\r\n  components: {},\r\n  methods: {\r\n    draw (data_) {\r\n    this.data = data_;\r\n    console.log(\"data\");\r\n    console.log(data_);\r\n      let series = d3\r\n        .stack()\r\n        .keys(this.data.columns.slice(1))\r\n        .offset(d3.stackOffsetExpand)(this.data)\r\n        .map((d) => (d.forEach((v) => (v.key = d.key)), d));\r\n\r\nconsole.log(\"series\");\r\n        console.log(series);\r\n\r\n      let color = d3\r\n        .scaleOrdinal()\r\n        .domain(series.map((d) => d.key))\r\n        .range(d3.schemeSpectral[series.length])\r\n        .unknown(\"#ccc\");\r\n\r\n      let margin = {\r\n        top: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        left: 0,\r\n      };\r\n\r\n      let width = 1330;\r\n      let height = this.data.length * 33 + margin.top + margin.bottom;\r\n      // console.log(height);\r\n\r\n      let svg = d3\r\n        .select(\"#svg1\")\r\n        .attr(\"viewBox\", [0, 0, width, height])\r\n        .style(\"overflow\", \"visible\");\r\n\r\n      let y = d3\r\n        .scaleBand()\r\n        .domain(this.data.map((d) => d.month))\r\n        .range([margin.top, height - margin.bottom])\r\n        .padding(0.08);\r\n\r\n      let x = d3.scaleLinear().range([margin.left, width - margin.right]);\r\n\r\n      let formatValue = (x) => (isNaN(x) ? \"N/A\" : x.toLocaleString(\"en\"));\r\n\r\n      let formatPercent = d3.format(\".1%\");\r\n\r\n      let arr_j = new Array();\r\n      let j = 0;\r\n      let postfix = \"\";\r\n      let length_y = series[0].length;\r\n\r\n      svg\r\n        .append(\"g\")\r\n        .selectAll(\"g\")\r\n        .data(series)\r\n        .enter()\r\n        .append(\"g\")\r\n        .attr(\"fill\", function (d, i) {\r\n          if (i + 1 == 1) arr_j[j++] = i + 1 + \"a\";\r\n          // ???\r\n          else if (i + 1 == 2) arr_j[j++] = i + \"b\";\r\n          else arr_j[j++] = i;\r\n          // console.log(i);\r\n          return color(d.key);\r\n        })\r\n        .selectAll(\"rect\")\r\n        .data(function (d) {\r\n          j = 0;\r\n          return d;\r\n        })\r\n        .join(\"rect\")\r\n        .attr(\"id\", function (d, i) {\r\n          let id = \"\";\r\n          if (j % length_y == 0) {\r\n            postfix = arr_j[j / length_y];\r\n            id = \"F1A_\" + (i + 1) + \"_\" + postfix;\r\n          } else {\r\n            id = \"F1A_\" + (i + 1) + \"_\" + postfix;\r\n          }\r\n          // console.log(\"F1A_\" + (i + 1) + \"_\" + arr_j[(j) / length_y]);\r\n          j++;\r\n          return id;\r\n        })\r\n        .attr(\"class\", (d) => `${d.data.month}${d.key}`)\r\n        .attr(\"x\", function (d) { return x(d[0]);})\r\n        .attr(\"y\", function (d) {return y(d.data.month);} )\r\n        .attr(\"width\", (d) => x(d[1]) - x(d[0]))\r\n        .attr(\"height\", y.bandwidth());\r\n\r\n      var font;\r\n\r\n      svg\r\n        .selectAll(\"rect\")\r\n        .on(\"mouseover\", function () {\r\n          // console.log(this);\r\n          // console.log(d3.select(this)._groups[0]);\r\n          d3.select(this)\r\n            .attr(\"fill\", \"yellow\")\r\n            .append(\"title\")\r\n            .text(\r\n              (d) => `${d.data.month} ${d.key}\r\n\t\t\t\t\t\t\t\t\t\t\t${formatPercent(d[1] - d[0])} (${formatValue(d.data[d.key])})`\r\n            );\r\n\r\n          font = document.getElementById(\"test0\").style.font;\r\n          document.getElementById(\"test0\").style.font =\r\n            \"italic 20px arial,serif\";\r\n        })\r\n        .on(\"mouseout\", function () {\r\n          d3.select(this)\r\n            .transition()\r\n            .duration(500)\r\n            .attr(\"fill\", (d) => color(d.key));\r\n\r\n          document.getElementById(\"test0\").style.font = font;\r\n        });\r\n\r\n      let yAxis = (g) =>\r\n        g\r\n          .attr(\"transform\", `translate(${margin.left},0)`)\r\n          .call(d3.axisLeft(y).tickSizeOuter(0))\r\n          .call((g) => g.selectAll(\".domain\").remove());\r\n\r\n      let xAxis = (g) =>\r\n        g\r\n          .attr(\"transform\", `translate(0,${margin.top})`)\r\n          .call(d3.axisTop(x).ticks(width / 100, \"%\"))\r\n          .call((g) => g.selectAll(\".domain\").remove());\r\n\r\n      svg.append(\"g\").call(xAxis);\r\n\r\n      svg.append(\"g\").call(yAxis);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\nchart-info {\r\n  font-size: 14px;\r\n  color: #0000ff;\r\n  font-weight: bold;\r\n  text-align: center;\r\n  margin-left: 30%;\r\n}\r\n.rightC {\r\n  margin-left: 42%;\r\n  margin-top: -17%;\r\n}\r\n/* #svgCurve2 {\r\n  position: absolute;\r\n  border: 2px dashed purple;\r\n  width: 300px;\r\n  height: 120px;\r\n  left: 11%;\r\n} */\r\n</style>"]}]}